datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

// جدول المباريات
model Match {
  id             Int      @id @default(autoincrement())

  teamA_id       Int
  teamB_id       Int

  starter_player_id  Int?
  winner_team_id    Int?
  final_score    Int
  notes          String?
  match_date     DateTime

  // علاقة الفريق A بالمباراة
  teamA          Team     @relation("TeamA", fields: [teamA_id], references: [id])
  // علاقة الفريق B بالمباراة
  teamB          Team     @relation("TeamB", fields: [teamB_id], references: [id])

  // الجولات المرتبطة بالمباراة
  rounds         Round[]
}

// جدول الجولات داخل المباراة
model Round {
  id            Int     @id @default(autoincrement())
  match_id      Int
  round_number  Int
  game_type     String
  round_score   Int
  round_details String?

  match         Match   @relation(fields: [match_id], references: [id])
}

// جدول الفرق
model Team {
  id       Int      @id @default(autoincrement())
  name     String

  // علاقة الفريق باللاعبين (Many-to-Many)
  players  Player[] @relation("TeamPlayers")

  // العلاقة مع المباريات
  matchesA Match[]  @relation("TeamA")
  matchesB Match[]  @relation("TeamB")
}

// جدول اللاعبين
model Player {
  id      Int     @id @default(autoincrement())
  name    String

  // علاقة Many-to-Many بالفرق
  teams   Team[]  @relation("TeamPlayers")
}
